<!DOCTYPE html>
<!--suppress ES6ModulesDependencies -->
<html lang="en">

<head>
    <title>Robot Robby - genetic algorithm</title>
    <link href="css/main.css" rel="stylesheet">
</head>

<body>

<div class="container">
    <h1>Robot Robby - genetic algorithm</h1>
    <br>NOTE: The page will only run correctly in ES6 compatible (newer) browsers.<br>
    <small>
        repository: <a href="https://github.com/gmamaladze/genetic-robby">github.com/gmamaladze/genetic-robby</a> |
        (c) George Mamaladze |
        license: MIT
    </small>
</div>


<div class="container">
    <div class="box left" id="simulation">
        <span id="title"> </span>
    </div>
</div>

<div class="text">
    <h2>What is this?</h2>
    <p>
       Description:
    <ul>
        <li>
            line 1
        </li>
    </ul>
    </p>
    <p>
        It is a toy. You can see how the robot is trained and gets gradually better.
    </p>
</div>


<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="js/geneticrobby.js"></script>
<script>

    const interval = 50;
    let url = '/gen-3000.json';
    let dna = null;

    fetch(url)
        .then(res => res.json())
        .then((out) => {
            dna = out.bestSurvivor.dna;
        })
        .catch(err => {
            throw err
        });

    (function simulator() {
        let game = new geneticrobby.Game();
        let grid = new geneticrobby.Grid("#simulation", "#title");

        function loop() {
            game.tick(function draw(cells) {
                let text = `moves: ${game.moves()} | score: ${game.score()}`;
                grid.draw(cells, text);
            });
            if (game.isOver()) {
                game = new geneticrobby.Game(dna);
            }
            setTimeout(loop, interval);
        }

        loop();
    })();
</script>


</body>

</html>
